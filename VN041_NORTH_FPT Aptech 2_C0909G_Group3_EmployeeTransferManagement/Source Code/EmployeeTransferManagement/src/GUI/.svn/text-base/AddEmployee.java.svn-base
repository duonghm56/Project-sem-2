/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * AddEmployee.java
 *
 * Created on Nov 11, 2010, 10:14:15 AM
 */
package GUI;

import DataAccess.DepartmentDAO;
import DataAccess.EmployeeDAO;
import DataAccess.LocationDAO;
import DataAccess.ProjectDAO;
import Entity.Employee;
import java.sql.SQLException;
import java.util.Vector;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.DefaultComboBoxModel;
import javax.swing.JOptionPane;

/**
 *
 * @author PROXUANTHI
 */
public class AddEmployee extends javax.swing.JFrame {
    private Employee objEmpl = null;
    private boolean flag = false;
    private int employeeID = 0;

    /** Creates new form AddEmployee */
    public AddEmployee() throws SQLException {
        initComponents();
        loadLocation();
        loadDeparment();
        loadProject();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        lblName = new javax.swing.JLabel();
        txtFullName = new javax.swing.JTextField();
        lblUsername = new javax.swing.JLabel();
        txtUsername = new javax.swing.JTextField();
        lblPassword = new javax.swing.JLabel();
        lblRole = new javax.swing.JLabel();
        txtRole = new javax.swing.JTextField();
        password = new javax.swing.JPasswordField();
        cbWorkExperience = new javax.swing.JComboBox();
        lblWorkPerience = new javax.swing.JLabel();
        lblAddress = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        txaAddress = new javax.swing.JTextArea();
        lblEmail = new javax.swing.JLabel();
        txtEmail = new javax.swing.JTextField();
        lblGender = new javax.swing.JLabel();
        cbGender = new javax.swing.JComboBox();
        lblAllowance = new javax.swing.JLabel();
        txtAllowance = new javax.swing.JTextField();
        lblLocation = new javax.swing.JLabel();
        cbLocation = new javax.swing.JComboBox();
        lblDepartment = new javax.swing.JLabel();
        cbDepartment = new javax.swing.JComboBox();
        lblProject = new javax.swing.JLabel();
        cbProject = new javax.swing.JComboBox();
        lblBirth = new javax.swing.JLabel();
        txtBirthday = new javax.swing.JTextField();
        btnAdd = new javax.swing.JButton();
        btnReset = new javax.swing.JButton();
        btnExit = new javax.swing.JButton();
        lblTite = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);

        jPanel1.setPreferredSize(new java.awt.Dimension(1774, 720));

        lblName.setText("Full Name");

        txtFullName.setColumns(25);
        txtFullName.setText("Thanh");

        lblUsername.setText("Username");

        txtUsername.setColumns(25);
        txtUsername.setText("Thanhnx");

        lblPassword.setText("Password");

        lblRole.setText("Role");

        txtRole.setColumns(25);
        txtRole.setText("Coder");

        password.setColumns(25);
        password.setText("123456");

        cbWorkExperience.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "1", "2", "3", "4", "5", "6", "7", "8", "9", "10" }));
        cbWorkExperience.setPreferredSize(new java.awt.Dimension(60, 20));

        lblWorkPerience.setText("Work Experience");

        lblAddress.setText("Address");

        txaAddress.setColumns(25);
        txaAddress.setRows(5);
        txaAddress.setText("Thai nguyen");
        jScrollPane1.setViewportView(txaAddress);

        lblEmail.setText("Email");

        txtEmail.setColumns(25);
        txtEmail.setText("thanhnx_luv@yahoo.com.vn");

        lblGender.setText("Gender");

        cbGender.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Gender", "Male", "Female" }));

        lblAllowance.setText("Allowance");

        txtAllowance.setColumns(15);
        txtAllowance.setText("1000");

        lblLocation.setText("Location");

        cbLocation.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        cbLocation.setMinimumSize(new java.awt.Dimension(250, 18));
        cbLocation.setPreferredSize(new java.awt.Dimension(207, 20));

        lblDepartment.setText("Department");

        cbDepartment.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        cbDepartment.setPreferredSize(new java.awt.Dimension(207, 20));

        lblProject.setText("Project");

        cbProject.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        cbProject.setPreferredSize(new java.awt.Dimension(207, 20));

        lblBirth.setText("Birthday");

        txtBirthday.setColumns(25);
        txtBirthday.setText("1990-10-10");

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblUsername)
                    .addComponent(lblPassword)
                    .addComponent(lblRole)
                    .addComponent(lblProject)
                    .addComponent(lblDepartment)
                    .addComponent(lblLocation)
                    .addComponent(lblAllowance)
                    .addComponent(lblGender)
                    .addComponent(lblBirth)
                    .addComponent(lblEmail)
                    .addComponent(lblAddress)
                    .addComponent(lblWorkPerience)
                    .addComponent(lblName))
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(cbWorkExperience, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtRole, javax.swing.GroupLayout.DEFAULT_SIZE, 226, Short.MAX_VALUE)
                    .addComponent(password, javax.swing.GroupLayout.DEFAULT_SIZE, 226, Short.MAX_VALUE)
                    .addComponent(txtUsername, javax.swing.GroupLayout.DEFAULT_SIZE, 226, Short.MAX_VALUE)
                    .addComponent(txtBirthday, javax.swing.GroupLayout.DEFAULT_SIZE, 226, Short.MAX_VALUE)
                    .addComponent(txtEmail, javax.swing.GroupLayout.DEFAULT_SIZE, 226, Short.MAX_VALUE)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 226, Short.MAX_VALUE)
                    .addComponent(cbGender, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtAllowance, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbLocation, 0, 226, Short.MAX_VALUE)
                    .addComponent(cbDepartment, 0, 226, Short.MAX_VALUE)
                    .addComponent(cbProject, 0, 226, Short.MAX_VALUE)
                    .addComponent(txtFullName, javax.swing.GroupLayout.DEFAULT_SIZE, 226, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(16, 16, 16)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblName)
                    .addComponent(txtFullName, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblUsername)
                    .addComponent(txtUsername, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblPassword)
                    .addComponent(password, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblRole)
                    .addComponent(txtRole, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblWorkPerience)
                    .addComponent(cbWorkExperience, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblAddress)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblEmail)
                    .addComponent(txtEmail, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblBirth)
                    .addComponent(txtBirthday, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblGender)
                    .addComponent(cbGender, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblAllowance)
                    .addComponent(txtAllowance, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblLocation)
                    .addComponent(cbLocation, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblDepartment)
                    .addComponent(cbDepartment, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblProject)
                    .addComponent(cbProject, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        btnAdd.setText("Add");
        btnAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAddActionPerformed(evt);
            }
        });

        btnReset.setText("Reset");

        btnExit.setText("Exit");
        btnExit.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExitActionPerformed(evt);
            }
        });

        lblTite.setFont(new java.awt.Font("Arial", 0, 14));
        lblTite.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTite.setText("Add Employee");

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(87, 87, 87)
                        .addComponent(lblTite, javax.swing.GroupLayout.PREFERRED_SIZE, 187, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(layout.createSequentialGroup()
                        .addGap(94, 94, 94)
                        .addComponent(btnAdd)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnReset)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(btnExit))
                    .addGroup(layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 347, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(29, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(lblTite)
                .addGap(18, 18, 18)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 493, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnAdd)
                    .addComponent(btnReset)
                    .addComponent(btnExit))
                .addContainerGap(29, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    public void loadLocation() throws SQLException {
        Vector v = new Vector();
        v = LocationDAO.getLocationFromDB();
        cbLocation.setModel(new DefaultComboBoxModel(v));
    }

    public void loadDeparment() throws SQLException {
        Vector v = new Vector();
        v = DepartmentDAO.getDepartmentFromDB();
        cbDepartment.setModel(new DefaultComboBoxModel(v));
    }

    public void loadProject() throws SQLException {
        Vector v = new Vector();
        v = ProjectDAO.getProjectFromDB();
        cbProject.setModel(new DefaultComboBoxModel(v));
    }

    public void loadEmployee(Employee objEmpl) {
        flag = true;
        employeeID = objEmpl.getEmployeeID();
        lblTite.setText("Edit Employee ID:" + employeeID);
        btnAdd.setText("Update");
        txtFullName.setText(objEmpl.getEmployeeName());
        txtUsername.setText(objEmpl.getUsername());
        txtRole.setText(objEmpl.getEmployeeRole());
        txtEmail.setText(objEmpl.getEmail());
        txtBirthday.setText(objEmpl.getBirthday());
        txtAllowance.setText(String.valueOf(objEmpl.getAllowance()));

    }

    public void insertEmployee() throws SQLException {
        objEmpl = new Employee();
        objEmpl.setEmployeeName(txtFullName.getText());
        objEmpl.setUsername(txtUsername.getText());
        objEmpl.setPassword(String.valueOf(password.getPassword()));
        objEmpl.setEmployeeRole(txtRole.getText());
        objEmpl.setWorkExperience(Integer.parseInt((String) cbWorkExperience.getSelectedItem()));
        objEmpl.setAddress(txaAddress.getText());
        objEmpl.setEmail(txtEmail.getText());
        objEmpl.setBirthday(txtBirthday.getText());
        objEmpl.setGender((String) cbGender.getSelectedItem());
        objEmpl.setAllowance(Float.parseFloat(txtAllowance.getText()));
        objEmpl.setLocationID(LocationDAO.getLocationID((String) cbLocation.getSelectedItem()));
        objEmpl.setDepartmentID(DepartmentDAO.getDepartmentID((String) cbDepartment.getSelectedItem()));
        objEmpl.setProjectID(ProjectDAO.getProjectID((String) cbProject.getSelectedItem()));
        EmployeeDAO.insertEmployee(objEmpl);
    }

    public void updateEmployee() throws SQLException {
        objEmpl = new Employee();
        objEmpl.setEmployeeName(txtFullName.getText());
        objEmpl.setUsername(txtUsername.getText());
        objEmpl.setPassword(String.valueOf(password.getPassword()));
        objEmpl.setEmployeeRole(txtRole.getText());
        objEmpl.setWorkExperience(Integer.parseInt((String) cbWorkExperience.getSelectedItem()));
        objEmpl.setAddress(txaAddress.getText());
        objEmpl.setEmail(txtEmail.getText());
        objEmpl.setBirthday(txtBirthday.getText());
        objEmpl.setGender((String) cbGender.getSelectedItem());
        objEmpl.setAllowance(Float.parseFloat(txtAllowance.getText()));
        objEmpl.setLocationID(LocationDAO.getLocationID((String) cbLocation.getSelectedItem()));
        objEmpl.setDepartmentID(DepartmentDAO.getDepartmentID((String) cbDepartment.getSelectedItem()));
        objEmpl.setProjectID(ProjectDAO.getProjectID((String) cbProject.getSelectedItem()));
        EmployeeDAO.updateEmployee(objEmpl, employeeID);
    }

    public boolean validateSelect() {
        if (cbDepartment.getSelectedIndex() == 0 || cbLocation.getSelectedIndex() == 0 || cbProject.getSelectedIndex() == 0 || cbGender.getSelectedIndex() == 0) {

            return false;
        } else {
            return true;
        }
    }
    private void btnAddActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAddActionPerformed
        try {
            // TODO add your handling code here:
            if (!flag) {
                if (validateSelect()) {
                    insertEmployee();
                    JOptionPane.showMessageDialog(null, "Add Employee successfully");
                    MainAdministrator.onLoadTableEmployee();
                    this.dispose();

                } else {
                    JOptionPane.showMessageDialog(null, "Please select Information");
                }
            } else {
                if (validateSelect()) {
                    updateEmployee();
                    JOptionPane.showMessageDialog(null, "Update Employee successfully");
                    this.dispose();
                } else {
                    JOptionPane.showMessageDialog(null, "Please select Information");
                }
            }
        } catch (SQLException ex) {
            Logger.getLogger(AddEmployee.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnAddActionPerformed

    private void btnExitActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExitActionPerformed
        // TODO add your handling code here:
        this.dispose();
    }//GEN-LAST:event_btnExitActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                try {
                    AddEmployee addEmployee = new AddEmployee();
                    addEmployee.setLocationRelativeTo(addEmployee);
                    addEmployee.setVisible(true);
                } catch (SQLException ex) {
                    Logger.getLogger(AddEmployee.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
        });
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnAdd;
    private javax.swing.JButton btnExit;
    private javax.swing.JButton btnReset;
    private javax.swing.JComboBox cbDepartment;
    private javax.swing.JComboBox cbGender;
    private javax.swing.JComboBox cbLocation;
    private javax.swing.JComboBox cbProject;
    private javax.swing.JComboBox cbWorkExperience;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JLabel lblAddress;
    private javax.swing.JLabel lblAllowance;
    private javax.swing.JLabel lblBirth;
    private javax.swing.JLabel lblDepartment;
    private javax.swing.JLabel lblEmail;
    private javax.swing.JLabel lblGender;
    private javax.swing.JLabel lblLocation;
    private javax.swing.JLabel lblName;
    private javax.swing.JLabel lblPassword;
    private javax.swing.JLabel lblProject;
    private javax.swing.JLabel lblRole;
    private javax.swing.JLabel lblTite;
    private javax.swing.JLabel lblUsername;
    private javax.swing.JLabel lblWorkPerience;
    private javax.swing.JPasswordField password;
    private javax.swing.JTextArea txaAddress;
    private javax.swing.JTextField txtAllowance;
    private javax.swing.JTextField txtBirthday;
    private javax.swing.JTextField txtEmail;
    private javax.swing.JTextField txtFullName;
    private javax.swing.JTextField txtRole;
    private javax.swing.JTextField txtUsername;
    // End of variables declaration//GEN-END:variables
}
